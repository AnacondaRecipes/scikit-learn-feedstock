From c7363b631a9b9f6721409d264a4878210cd94b95 Mon Sep 17 00:00:00 2001
From: Guillaume Lemaitre <g.lemaitre58@gmail.com>
Date: Thu, 29 Sep 2022 15:40:00 +0200
Subject: [PATCH 02/06] handle the case with only nan values

---
 sklearn/model_selection/_search.py | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/sklearn/model_selection/_search.py b/sklearn/model_selection/_search.py
index 11799fa0c47f7..81ef331458f68 100644
--- a/sklearn/model_selection/_search.py
+++ b/sklearn/model_selection/_search.py
@@ -969,6 +969,9 @@ def _store(key_name, array, weights=None, splits=False, rank=False):
                 # keep previous behaviour nans are set to be smaller than the
                 # minimum value in the array before ranking
                 min_array_means = np.nanmin(array_means) - 1
+                if np.isnan(min_array_means):
+                    # all values in array_means are nan. Set min_array_means to 0
+                    min_array_means = 0
                 array_means = np.nan_to_num(array_means, copy=True, nan=min_array_means)
                 rank_result = rankdata(-array_means, method="min")
                 rank_result = np.asarray(rank_result, dtype=np.int32)
